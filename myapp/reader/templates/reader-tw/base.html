{% load static %}
{% load books_extras %}

<!DOCTYPE html>
<html lang="{{ current_language.code|default:'en' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %} - wereadly</title>

    <!-- Dark mode script - prevent FOUC -->
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }
    </script>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'reader/favicon.ico' %}">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- Reader App Styles -->
    <link href="{% static 'reader-tw/css/output.css' %}" rel="stylesheet">

    {% block extra_css %}{% endblock %}
</head>

<body class="bg-stone-50 dark:bg-stone-800">
    <!-- Navigation -->
    <nav class="nav-bar">
        <!-- Left Side Navigation -->
        <div class="flex-none">
            <a href="{% if current_language %}{% url 'reader:welcome' current_language.code %}{% else %}/{% endif %}">
                <span class="text-xl font-bold text-orange-500 ">We</span><!--
                --><span class="text-xl font-bold text-black dark:text-gray-200">readly</span>
            </a>
        </div>

        <!-- Inline Breadcrumb -->
        {% if current_language %}
        <div class="flex-none">            
            {% block breadcrumb_section %}
                {% block breadcrumb_check %}
                {# This block will be overridden in child templates to show breadcrumb #}
                {% endblock %}
            {% endblock %}            
        </div>
        {% endif %}

        <!-- Genres Dropdown-->
        {% if genres %}
        <div class="flex-auto relative" id="genres-dropdown-container">
            <button class="btn btn-ghost btn-square" id="genres-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <ul id="genres-dropdown" class="dropdown-menu hidden absolute left-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg z-50">
                <li>
                    <a class="dropdown-item block px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 border-b-2" href="{% url 'reader:genre_list' current_language.code %}">
                        All genres
                    </a>                    
                </li>
                {% for genre in genres %}
                <li>
                    <a class="dropdown-item block px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700" href="{% url 'reader:genre_book_list' current_language.code genre.slug %}">
                        {{ genre.localized_name }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <!-- Theme Switcher -->
        <div class="flex-none">
            <button type="button" id="theme-toggle" class="nav-item">
                <i class="fas fa-moon" id="theme-icon-moon"></i>
                <i class="fas fa-sun" id="theme-icon-sun"></i>
            </button>
        </div>

        <!-- Language Switcher -->
        {% if languages %}
        <div class="flex-none relative" id="language-dropdown-container">
            <button type="button" id="language-toggle" class="nav-item">
                <i class="fas fa-globe"></i>
            </button>
            <ul id="language-dropdown" class="dropdown-menu hidden absolute right-0 mt-2 w-36 bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 py-1">
                {% for lang in languages %}
                <li>
                    <a class="dropdown-item block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 {% if lang == current_language %}bg-blue-100 dark:bg-blue-900{% endif %}" href="{% url 'reader:welcome' lang.code %}">
                        <div class="flex justify-between gap-4">
                            <span class="font-bold text-sm">{{ lang.code|upper }}</span>
                            <span class="text-sm">{{ lang.local_name }}</span>
                        </div>
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </nav>

    <div class="navbar bg-base-100 shadow-sm">
    <div class="navbar-start">
        <div class="dropdown">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" /> </svg>
        </div>
        <ul
            tabindex="-1"
            class="menu menu-sm dropdown-content bg-base-100 rounded-box z-1 mt-3 w-52 p-2 shadow">
            <li><a>Homepage</a></li>
            <li><a>Portfolio</a></li>
            <li><a>About</a></li>
        </ul>
        </div>
    </div>
    <div class="navbar-center">
        <a class="btn btn-ghost text-xl">daisyUI</a>
    </div>
    <div class="navbar-end">
        <button class="btn btn-ghost btn-circle">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /> </svg>
        </button>
        <button class="btn btn-ghost btn-circle">
        <div class="indicator">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /> </svg>
            <span class="badge badge-xs badge-primary indicator-item"></span>
        </div>
        </button>
    </div>
    </div>

    <!-- Main Content -->
    <main >
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer >
        <div >
            <p >Â© 2025 wereadly</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="{% static 'reader-tw/js/script.js' %}"></script>

    {% block extra_js %}{% endblock %}
</body>
</html>